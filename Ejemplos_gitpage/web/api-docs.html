<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Documentation - Personas</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        main {
            padding: 40px;
        }

        .section {
            margin-bottom: 30px;
        }

        .section h2 {
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #0066cc;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }

        .success-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }

        code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        pre {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 10px 0;
        }

        .button-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1em;
            transition: transform 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button.secondary {
            background: #6c757d;
        }

        button.success {
            background: #28a745;
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        table th {
            background: #667eea;
            color: white;
            padding: 12px;
            text-align: left;
        }

        table td {
            padding: 12px;
            border-bottom: 1px solid #ddd;
        }

        table tr:hover {
            background: #f5f5f5;
        }

        .status-local {
            color: #28a745;
            font-weight: bold;
        }

        .status-github {
            color: #dc3545;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }

            main {
                padding: 20px;
            }

            .button-group {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìö API Documentation</h1>
            <p>PersonasAPI - ASP.NET Core 10</p>
        </header>

        <main>
            <!-- Swagger/OpenAPI -->
            <div class="section">
                <h2>üîç Swagger/OpenAPI - Documentaci√≥n Interactiva</h2>

                <div class="warning-box">
                    <strong>‚ö†Ô∏è Importante:</strong> Swagger <strong>SOLO funciona cuando el servidor est√° ejecut√°ndose localmente.</strong>
                </div>

                <div id="swaggerContainer">
                    <div class="info-box">
                        <p><strong>Estado:</strong> Detectando servidor...</p>
                    </div>
                </div>

                <div class="button-group">
                    <button onclick="checkSwagger()">üîç Verificar Swagger</button>
                    <button class="secondary" onclick="goToApiDocs()">üìñ Ver documentaci√≥n API</button>
                </div>
            </div>

            <!-- Instrucciones -->
            <div class="section">
                <h2>‚ö° Para Acceder a Swagger</h2>

                <div class="success-box">
                    <strong>‚úÖ OPCI√ìN 1: Desarrollo Local (Recomendado)</strong>
                    <ol style="margin-top: 10px;">
                        <li>Abre una terminal en la carpeta <code>PersonasAPI</code></li>
                        <li>Ejecuta: <code>dotnet run</code></li>
                        <li>Abre en el navegador: <code>http://localhost:5265/swagger</code></li>
                    </ol>
                </div>

                <div class="info-box">
                    <strong>‚ÑπÔ∏è OPCI√ìN 2: Production/Servidor Remoto</strong>
                    <p>Si desployas el backend a un servidor (Azure, VPS, etc.):</p>
                    <code>https://tu-servidor.com/swagger</code>
                </div>

                <div class="warning-box">
                    <strong>‚ùå NO funciona en GitHub Pages</strong>
                    <p>GitHub Pages solo sirve contenido est√°tico (HTML/CSS/JS).</p>
                    <p>Swagger requiere un servidor ASP.NET ejecut√°ndose.</p>
                </div>
            </div>

            <!-- URLs locales -->
            <div class="section">
                <h2>üîó URLs Locales (Solo con dotnet run)</h2>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Recurso</th>
                                <th>URL Local</th>
                                <th>Descripci√≥n</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Swagger UI</strong></td>
                                <td><code>http://localhost:5265/swagger</code></td>
                                <td>Documentaci√≥n interactiva</td>
                            </tr>
                            <tr>
                                <td><strong>OpenAPI JSON</strong></td>
                                <td><code>http://localhost:5265/openapi/v1.json</code></td>
                                <td>Especificaci√≥n OpenAPI</td>
                            </tr>
                            <tr>
                                <td><strong>API Personas</strong></td>
                                <td><code>http://localhost:5265/api/personas</code></td>
                                <td>Obtener todas las personas</td>
                            </tr>
                            <tr>
                                <td><strong>Health Check</strong></td>
                                <td><code>http://localhost:5265/health</code></td>
                                <td>Verificar estado del servicio</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Endpoints -->
            <div class="section">
                <h2>üì° Endpoints Disponibles</h2>

                <div class="info-box">
                    <strong>GET /api/personas</strong>
                    <p>Obtener todas las personas</p>
                    <pre>curl http://localhost:5265/api/personas</pre>
                </div>

                <div class="info-box">
                    <strong>GET /api/personas/{id}</strong>
                    <p>Obtener persona por ID</p>
                    <pre>curl http://localhost:5265/api/personas/1</pre>
                </div>

                <div class="info-box">
                    <strong>POST /api/personas</strong>
                    <p>Crear nueva persona</p>
                    <pre>curl -X POST http://localhost:5265/api/personas \
  -H "Content-Type: application/json" \
  -d '{
    "nombre": "Juan",
    "apellido": "P√©rez",
    "email": "juan@example.com",
    "edad": 30
  }'</pre>
                </div>

                <div class="info-box">
                    <strong>PUT /api/personas/{id}</strong>
                    <p>Actualizar persona</p>
                    <pre>curl -X PUT http://localhost:5265/api/personas/1 \
  -H "Content-Type: application/json" \
  -d '{"nombre": "Juan Carlos"}'</pre>
                </div>

                <div class="info-box">
                    <strong>DELETE /api/personas/{id}</strong>
                    <p>Eliminar persona</p>
                    <pre>curl -X DELETE http://localhost:5265/api/personas/1</pre>
                </div>
            </div>

            <!-- Troubleshooting -->
            <div class="section">
                <h2>üîß Soluci√≥n de Problemas</h2>

                <div class="warning-box">
                    <strong>¬øPor qu√© Swagger no aparece en GitHub Pages?</strong>
                    <p>GitHub Pages solo sirve archivos est√°ticos. Swagger es generado din√°micamente por el servidor ASP.NET. Para usarlo, debes tener el servidor ejecut√°ndose.</p>
                </div>

                <div class="info-box">
                    <strong>¬øC√≥mo verificar si el servidor est√° corriendo?</strong>
                    <pre>curl http://localhost:5265/health</pre>
                    <p>Si ves una respuesta JSON, el servidor est√° activo. Si no, ejecuta <code>dotnet run</code> primero.</p>
                </div>

                <div class="success-box">
                    <strong>‚úÖ Recomendaci√≥n</strong>
                    <p>Usa la interfaz CRUD en <code>web/index.html</code> para interactuar con la API desde GitHub Pages.</p>
                    <p>Usa Swagger en <code>http://localhost:5265/swagger</code> para documentaci√≥n detallada durante desarrollo.</p>
                </div>
            </div>

            <!-- Botones de navegaci√≥n -->
            <div class="button-group" style="margin-top: 40px;">
                <button onclick="window.location.href='index.html'">üì± Volver a Interfaz CRUD</button>
                <button class="secondary" onclick="window.location.href='config.html'">‚öôÔ∏è Configurar API</button>
            </div>
        </main>
    </div>

    <script>
        async function checkSwagger() {
            const swaggerContainer = document.getElementById('swaggerContainer');
            
            try {
                const response = await fetch('http://localhost:5265/openapi/v1.json');
                
                if (response.ok) {
                    swaggerContainer.innerHTML = `
                        <div class="success-box">
                            <strong>‚úÖ Swagger est√° disponible</strong>
                            <p>El servidor ASP.NET est√° ejecut√°ndose en http://localhost:5265</p>
                            <button onclick="window.open('http://localhost:5265/swagger', '_blank')" 
                                    style="margin-top: 10px;">
                                üîç Abrir Swagger UI
                            </button>
                        </div>
                    `;
                } else {
                    throw new Error('Swagger no disponible');
                }
            } catch (error) {
                swaggerContainer.innerHTML = `
                    <div class="warning-box">
                        <strong>‚ùå Swagger no disponible</strong>
                        <p>El servidor ASP.NET no est√° ejecut√°ndose en http://localhost:5265</p>
                        <p style="margin-top: 10px;"><strong>Soluci√≥n:</strong></p>
                        <ol style="margin-top: 10px;">
                            <li>Abre una terminal</li>
                            <li>Navega a la carpeta PersonasAPI</li>
                            <li>Ejecuta: <code>dotnet run</code></li>
                            <li>Intenta nuevamente</li>
                        </ol>
                    </div>
                `;
            }
        }

        function goToApiDocs() {
            const docs = `
GET    /api/personas              Obtener todas las personas
GET    /api/personas/{id}         Obtener persona por ID
POST   /api/personas              Crear nueva persona
PUT    /api/personas/{id}         Actualizar persona
DELETE /api/personas/{id}         Eliminar persona
GET    /swagger                   Documentaci√≥n interactiva (local)
            `;
            alert(docs);
        }

        // Verificar Swagger autom√°ticamente al cargar
        window.addEventListener('load', () => {
            setTimeout(checkSwagger, 1000);
        });
    </script>
</body>
</html>
